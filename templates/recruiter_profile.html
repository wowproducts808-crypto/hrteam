{% extends "base.html" %}
{% block content %}
<div class="container" style="max-width: 800px;">
    
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–æ–ª–∏ -->
    {% if current_user.user_type.value == 'employer' %}
        <h2>üëî –ü—Ä–æ—Ñ–∏–ª—å —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—è: {{ current_user.name }}</h2>
    {% elif current_user.user_type.value == 'recruiter' %}
        <h2>üéØ –ü—Ä–æ—Ñ–∏–ª—å —Ä–µ–∫—Ä—É—Ç–µ—Ä–∞: {{ current_user.name }}</h2>
    {% else %}
        <h2>üë§ –ü—Ä–æ—Ñ–∏–ª—å: {{ current_user.name }}</h2>
    {% endif %}
    
    <!-- –¶–≤–µ—Ç–Ω–∞—è —à–∞–ø–∫–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–æ–ª–∏ -->
    {% if current_user.user_type.value == 'employer' %}
        <div style="background: linear-gradient(135deg, #007bff, #0056b3); color: white; padding: 30px; border-radius: 12px; margin-bottom: 30px;">
    {% elif current_user.user_type.value == 'recruiter' %}
        <div style="background: linear-gradient(135deg, #28a745, #20c997); color: white; padding: 30px; border-radius: 12px; margin-bottom: 30px;">
    {% else %}
        <div style="background: linear-gradient(135deg, #6c757d, #495057); color: white; padding: 30px; border-radius: 12px; margin-bottom: 30px;">
    {% endif %}
        <h3 style="margin: 0 0 10px 0;">{{ current_user.name }}</h3>
        <div style="opacity: 0.9; font-size: 16px;">
            {% if current_user.user_type.value == 'employer' %}
                üè¢ –†–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—å
            {% elif current_user.user_type.value == 'recruiter' %}
                üéØ –†–µ–∫—Ä—É—Ç–µ—Ä
            {% elif current_user.user_type.value == 'admin' %}
                ‚öôÔ∏è –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
            {% endif %}
            ‚Ä¢ üìÖ –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω {{ current_user.created_at.strftime('%d.%m.%Y') }}
        </div>
    </div>

   {% if request.query_params.get('updated') %}
    <div style="background: #d4edda; padding: 15px; border-radius: 8px; margin-bottom: 20px; color: #155724;">
        ‚úÖ –ü—Ä–æ—Ñ–∏–ª—å —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω!
    </div>
{% endif %}


    <form method="post" style="background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
        
        <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–¥–ª—è –≤—Å–µ—Ö) -->
        <div style="margin-bottom: 30px;">
            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #e9ecef; padding-bottom: 10px;">
                üìã –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            </h4>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; font-weight: 600; margin-bottom: 8px;">–ò–º—è –∏ —Ñ–∞–º–∏–ª–∏—è:</label>
                <input type="text" name="name" value="{{ current_user.name }}" required 
                       style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 16px;">
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div>
                    <label style="display: block; font-weight: 600; margin-bottom: 8px;">–¢–µ–ª–µ—Ñ–æ–Ω:</label>
                    <input type="text" name="phone" value="{{ current_user.phone or '' }}" 
                           style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px;">
                </div>
                <div>
                    <label style="display: block; font-weight: 600; margin-bottom: 8px;">–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:</label>
                    <input type="text" name="location" value="{{ current_user.location or '' }}" 
                           style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px;">
                </div>
            </div>
        </div>

        <!-- –ü–æ–ª—è –¥–ª—è —Ä–µ–∫—Ä—É—Ç–µ—Ä–æ–≤ -->
        {% if current_user.user_type.value == 'recruiter' %}
        <div style="margin-bottom: 30px;">
            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #e9ecef; padding-bottom: 10px;">
                üéØ –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            </h4>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; font-weight: 600; margin-bottom: 8px;">–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:</label>
                <input type="text" name="specialization" value="{{ current_user.specialization or '' }}" 
                       placeholder="IT —Ä–µ–∫—Ä—É—Ç–∏–Ω–≥, Executive Search, Mass recruitment"
                       style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px;">
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; font-weight: 600; margin-bottom: 8px;">–û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã:</label>
                <textarea name="experience" rows="4" 
                          placeholder="–û–ø–∏—à–∏—Ç–µ –≤–∞—à –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã –≤ —Å—Ñ–µ—Ä–µ —Ä–µ–∫—Ä—É—Ç–∏–Ω–≥–∞..."
                          style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; resize: vertical;">{{ current_user.experience or '' }}</textarea>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div>
                    <label style="display: block; font-weight: 600; margin-bottom: 8px;">–°—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ:</label>
                    <input type="url" name="portfolio_url" value="{{ current_user.portfolio_url or '' }}" 
                           placeholder="https://portfolio.example.com"
                           style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px;">
                </div>
                <div>
                    <label style="display: block; font-weight: 600; margin-bottom: 8px;">–°—Å—ã–ª–∫–∞ –Ω–∞ —Ä–µ–∑—é–º–µ:</label>
                    <input type="url" name="resume_url" value="{{ current_user.resume_url or '' }}" 
                           placeholder="https://resume.example.com"
                           style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px;">
                </div>
            </div>
        </div>
        {% endif %}

        <!-- –ü–æ–ª—è –¥–ª—è —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª–µ–π -->
        {% if current_user.user_type.value == 'employer' %}
        <div style="margin-bottom: 30px;">
            <h4 style="color: #2c3e50; margin-bottom: 20px; border-bottom: 2px solid #e9ecef; padding-bottom: 10px;">
                üè¢ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–º–ø–∞–Ω–∏–∏
            </h4>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; font-weight: 600; margin-bottom: 8px;">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏: *</label>
                <input type="text" name="company_name" value="{{ current_user.company_name or '' }}" required
                       style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 16px;">
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; font-weight: 600; margin-bottom: 8px;">–û–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏:</label>
                <textarea name="company_description" rows="4" 
                          style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; resize: vertical;">{{ current_user.company_description or '' }}</textarea>
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; font-weight: 600; margin-bottom: 8px;">–°–∞–π—Ç –∏–ª–∏ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏:</label>
                <input type="url" name="company_website" value="{{ current_user.company_website or '' }}" 
                       placeholder="https://example.com"
                       style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px;">
            </div>

            <div style="margin-bottom: 20px;">
                <label style="display: block; font-weight: 600; margin-bottom: 8px;">–†–µ–∫–≤–∏–∑–∏—Ç—ã –∫–æ–º–ø–∞–Ω–∏–∏:</label>
                <textarea name="company_details" rows="6" 
                          placeholder="–ë–ò–ù/–ò–ò–ù: 123456789012&#10;–ë–∞–Ω–∫: Kaspi Bank&#10;–°—á–µ—Ç: KZ123456789012345678&#10;–ê–¥—Ä–µ—Å: –≥. –ê–ª–º–∞—Ç—ã, —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è 123"
                          style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; resize: vertical; font-family: monospace;">{{ current_user.company_details or '' }}</textarea>
            </div>
        </div>
        {% endif %}

        <div style="text-align: center; padding-top: 20px; border-top: 2px solid #e9ecef;">
            <!-- –†–ï–®–ï–ù–ò–ï 1: –û—Ç–¥–µ–ª—å–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π —Ä–æ–ª–∏ -->
            {% if current_user.user_type.value == 'employer' %}
                <button type="submit" style="background: #007bff; color: white; padding: 15px 40px; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s;" onmouseover="this.style.background='#0056b3'" onmouseout="this.style.background='#007bff'">
                    üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
                </button>
            {% else %}
                <button type="submit" style="background: #28a745; color: white; padding: 15px 40px; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s;" onmouseover="this.style.background='#218838'" onmouseout="this.style.background='#28a745'">
                    üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
                </button>
            {% endif %}
        </div>
    </form>

    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–æ–ª–∏ -->
    {% if current_user.user_type.value == 'employer' and analytics %}
    <div style="background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-top: 30px;">
        <h4 style="color: #2c3e50; margin-bottom: 20px;">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—è</h4>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
            <div style="text-align: center; padding: 20px; background: #f8f9fa; border-radius: 8px;">
                <div style="font-size: 32px; font-weight: bold; color: #007bff;">{{ analytics.total_jobs or 0 }}</div>
                <div style="color: #6c757d;">–í—Å–µ–≥–æ –≤–∞–∫–∞–Ω—Å–∏–π</div>
            </div>
            <div style="text-align: center; padding: 20px; background: #f8f9fa; border-radius: 8px;">
                <div style="font-size: 32px; font-weight: bold; color: #28a745;">{{ analytics.completed_jobs or 0 }}</div>
                <div style="color: #6c757d;">–ó–∞–∫—Ä—ã—Ç—ã—Ö –≤–∞–∫–∞–Ω—Å–∏–π</div>
            </div>
            <div style="text-align: center; padding: 20px; background: #f8f9fa; border-radius: 8px;">
                <div style="font-size: 32px; font-weight: bold; color: #ffc107;">{{ analytics.success_rate or 0 }}%</div>
                <div style="color: #6c757d;">–£—Å–ø–µ—à–Ω–æ—Å—Ç—å</div>
            </div>
        </div>
    </div>
    {% endif %}

    {% if current_user.user_type.value == 'recruiter' and completed_jobs %}
    <div style="background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-top: 30px;">
        <h4 style="color: #2c3e50; margin-bottom: 20px;">üèÜ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã</h4>
        {% for job in completed_jobs %}
        <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
            <h5 style="margin: 0 0 5px 0; color: #007bff;">{{ job.title }}</h5>
            <small style="color: #6c757d;">{{ job.employer.name }} ‚Ä¢ {{ job.created_at.strftime('%m.%Y') }}</small>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
    <div style="text-align: center; margin-top: 30px;">
        {% if current_user.user_type.value == 'employer' %}
            <a href="/my/jobs" style="background: #28a745; color: white; padding: 12px 24px; border-radius: 8px; text-decoration: none; font-weight: 600; margin-right: 15px;">
                üìã –ú–æ–∏ –≤–∞–∫–∞–Ω—Å–∏–∏
            </a>
            <a href="/jobs/new" style="background: #17a2b8; color: white; padding: 12px 24px; border-radius: 8px; text-decoration: none; font-weight: 600;">
                ‚ûï –°–æ–∑–¥–∞—Ç—å –≤–∞–∫–∞–Ω—Å–∏—é
            </a>
        {% elif current_user.user_type.value == 'recruiter' %}
            <a href="/jobs" style="background: #007bff; color: white; padding: 12px 24px; border-radius: 8px; text-decoration: none; font-weight: 600; margin-right: 15px;">
                üîç –ù–∞–π—Ç–∏ –≤–∞–∫–∞–Ω—Å–∏–∏
            </a>
            <a href="/my/applications" style="background: #17a2b8; color: white; padding: 12px 24px; border-radius: 8px; text-decoration: none; font-weight: 600;">
                üìã –ú–æ–∏ –æ—Ç–∫–ª–∏–∫–∏
            </a>
        {% endif %}
    </div>
</div>
{% endblock %}
